#include <stdio.h>
#include <math.h> // only for sqrt() function
#include<stdlib.h>
const double PI=3.14159265359; // for circle calculations

double summation(double x1, double x2){
    return x1+x2;
}

double subtraction(double x1, double x2){
    return x1-x2;
}

double division(double x1, double x2){
    return x1/x2;
}

double multiplication(double x1, double x2){
    return x1*x2;
}
double square_root(double x1){
    return sqrt(x1);
}
double area_circ(double x1){
    return PI*x1*x1;
}
double circumference_circ(double x1){
    return 2*PI*x1;
}
double deg_to_rad(double x1){
    return (x1*PI)/180;
}

double exponential_f(double x1, int exponent){
    double mult=1.0;
    for (int i = 0; i < exponent; i++)
    {
        mult*=x1;
    }
    return mult;
    
}

double factoriel(int x1){
    int mult=1;
    for(int i=1;i<=x1;i++){
        mult*=i;
    }
    return mult;
}

double average(int length,int arr[]){
    int tot=0;
    for(int i=0;i<length;i++){
        tot+=arr[i];
    }
    return (double) tot/length;
}

double std(int length, int arr[]){
    int mean=average(length,arr); 
    int tot=0;
    for(int i=0;i<length;i++){
        tot+=(arr[i]-mean)*(arr[i]-mean);
    }
    return sqrt(tot)/length;
}

// NEW FUNCTIONS 

double sine(double x1){
    return sin(x1);
}

double cosine(double x1){
    return cos(x1);
}

double tangent(double x1){
    return tan(x1);
}

// Quadratic equation solver: ax^2 + bx + c = 0
void quadratic_eq(double a, double b, double c){
    double D = b*b - 4*a*c;

    if (D > 0){
        double r1 = (-b + sqrt(D)) / (2*a);
        double r2 = (-b - sqrt(D)) / (2*a);
        printf("Two real roots: x1 = %lf , x2 = %lf\n", r1, r2);
    }
    else if (D == 0){
        double r = -b / (2*a);
        printf("One real root: x = %lf\n", r);
    }
    else{
        double real = -b / (2*a);
        double imag = sqrt(-D) / (2*a);
        printf("Complex roots: x1 = %lf + %lfi , x2 = %lf - %lfi\n",
               real, imag, real, imag);
    }
}

// Linear equation ax + b = 0
void linear_eq(double a, double b){
    if (a == 0){
        printf("Not an equation or infinite solutions.\n");
        return;
    }
    double r = -b / a;
    printf("Root: x = %lf\n", r);
}

int main(){
    int choice,calc_space,index=0,angle,exponent,f_number;
    double x1,x2,result;
    int extra_calc_space=0;
    int extra_calc_choice;
    double* calc_hist;
    int arr_length; 

    printf("How many calculations do you want to make? ");
    scanf("%d",&calc_space);
    calc_hist= (double*) malloc(calc_space*sizeof(int));
    if (calc_hist==NULL)
    {
        printf("Memory allocation has been failed! \n");
    }
    else{
        printf("Memory allocation has been succeeded. \n");
    }

    do
    { 
        // menu
        printf("MENU\n");
        printf("---------------\n");
        printf("1) Summation\n");
        printf("2) Subtraction\n");
        printf("3) Multiplication\n");
        printf("4) Division\n");
        printf("5) Show history\n");
        printf("6) Square root\n");
        printf("7) Area of the circle\n");
        printf("8) Circumference of the circle\n");
        printf("9) Convert degree to rad\n");
        printf("10) Exponential (x^y)\n");
        printf("11) Factoriel\n");
        printf("12) Average of the given numbers\n");
        printf("13) Standart deviation\n");
        printf("15) Sin(x)\n");
        printf("16) Cos(x)\n");
        printf("17) Tan(x)\n");
        printf("18) Solve quadratic equation ax^2 + bx + c = 0\n");
        printf("19) Solve linear equation ax + b = 0\n");
        printf("20) Exit\n");
     

        if(index==calc_space+extra_calc_space){
            printf("You achieved maximum limit of calculatons that you entered.\n");
            printf("Do you want to calculate more? 1:Yes 0:No");
            scanf("%d",&extra_calc_choice);
            if (extra_calc_choice==1)
            {
                printf("How many more calculations do you want to make?");
                scanf("%d",&extra_calc_space);
                calc_hist= (double*) realloc(calc_hist,(calc_space+extra_calc_space)*sizeof(int));
                
            }
            else{
                printf("Exit the program. \n");
                return 0;
            }
        }

        printf("Please enter your choice 1-20: ");
        scanf("%d",&choice);

        if (choice<1 || choice>20)
        {
            printf("Please enter valid number.\n");
        }
        else
        {
            if (choice==1)
            {
                printf("Please enter the first number: ");
                scanf("%lf",&x1);
                printf("Please enter the second number: ");
                scanf("%lf",&x2);
                result=summation(x1,x2);
                *(calc_hist+index)=result;
                index=index+1;
                printf("%lf + %lf = %lf \n",x1,x2,result);
            }
            if (choice==2)
            {
                printf("Please enter the first number: ");
                scanf("%lf",&x1);
                printf("Please enter the second number: ");
                scanf("%lf",&x2);
                result=subtraction(x1,x2);
                *(calc_hist+index)=result;
                index=index+1;
                printf("%lf - %lf = %lf \n",x1,x2,result);
            }
            if (choice==3)
            {
                printf("Please enter the first number: ");
                scanf("%lf",&x1);
                printf("Please enter the second number: ");
                scanf("%lf",&x2);
                result=multiplication(x1,x2);
                *(calc_hist+index)=result;
                index=index+1;
                printf("%lf * %lf = %lf \n",x1,x2,result);
            }
            if (choice==4)
            {
                printf("Please enter the first number: ");
                scanf("%lf",&x1);
                printf("Please enter the second number: ");
                scanf("%lf",&x2);
                result=division(x1,x2);
                *(calc_hist+index)=result;
                index=index+1;
                printf("%lf / %lf = %lf \n",x1,x2,result);
            }
            if (choice==5)
            {
                for(int i=0;i<index;i++){
                    printf("%d. calculation: %lf \n",i+1,*(calc_hist+i));
                }
            }
            if (choice==6)
            {
                printf("Please enter the first number: ");
                scanf("%lf",&x1);
                result=square_root(x1);
                *(calc_hist+index)=result;
                index=index+1;
                printf("sqrt(%lf) = %lf \n",x1,result);
            }
            if (choice==7)
            {
                printf("Please enter the radius of the circle: ");
                scanf("%lf",&x1);
                result=area_circ(x1);
                *(calc_hist+index)=result;
                index=index+1;
                printf("%lf * %lf * %lf = %lf \n",PI,x1,x1,result);
            }
            if (choice==8)
            {
                printf("Please enter the radius of the circle: ");
                scanf("%lf",&x1);
                result=circumference_circ(x1);
                *(calc_hist+index)=result;
                index=index+1;
                printf("2 * %lf * %lf = %lf \n",PI,x1,result);
            }
            if (choice==9)
            {
                printf("Please enter an angle in degrees to convert rad: ");
                scanf("%d",&angle);
                result=deg_to_rad(angle);
                *(calc_hist+index)=result;
                index=index+1;
                printf("%d degrees = %lf rad \n",angle,result);
            }
            if (choice==10)
            {
                printf("Please enter the base: ");
                scanf("%lf",&x1);
                printf("Please enter the exponent: ");
                scanf("%d",&exponent);
                result=exponential_f(x1,exponent);
                *(calc_hist+index)=result;
                index=index+1;
                printf("%lf ^ %d = %lf \n",x1,exponent,result);
            }
            if (choice==11)
            {
                printf("Please enter the number to achieve factoriel: ");
                scanf("%d",&f_number);
                result=factoriel(f_number);
                *(calc_hist+index)=result;
                index=index+1;
                printf("%d ! = %d \n",f_number,(int)result);
            }
            if (choice==12)
            {
                printf("Please enter the lenght of the list of numbers: ");
                scanf("%d",&arr_length);

                int array[arr_length];

                for(int i=0;i<arr_length;i++){
                    printf("Please enter a number to add the list: ");
                    scanf("%d",&array[i]);
                }
                result=average(arr_length,array);
                *(calc_hist+index)=result;
                index=index+1;
                printf("Average of the given numbers is: %lf \n",result);
            }
            if (choice==13)
            {
                printf("Please enter the lenght of the list of numbers: ");
                scanf("%d",&arr_length);

                int array[arr_length];

                for(int i=0;i<arr_length;i++){
                    printf("Please enter a number to add the list: ");
                    scanf("%d",&array[i]);
                }
                result=std(arr_length,array);
                *(calc_hist+index)=result;
                index=index+1;
                printf("Standart deviation of the given numbers is: %lf \n",result);
            }

            // ---------------------------------------
            // NEW OPTIONS
            // ---------------------------------------

            if (choice == 15)
            {
                printf("Enter angle in degrees: ");
                scanf("%lf", &x1);
                double rad = deg_to_rad(x1);
                result = sine(rad);
                *(calc_hist+index) = result;
                index++;
                printf("sin(%lf°) = %lf\n", x1, result);
            }

            if (choice == 16)
            {
                printf("Enter angle in degrees: ");
                scanf("%lf", &x1);
                double rad = deg_to_rad(x1);
                result = cosine(rad);
                *(calc_hist+index) = result;
                index++;
                printf("cos(%lf°) = %lf\n", x1, result);
            }

            if (choice == 17)
            {
                printf("Enter angle in degrees: ");
                scanf("%lf", &x1);
                double rad = deg_to_rad(x1);
                result = tangent(rad);
                *(calc_hist+index) = result;
                index++;
                printf("tan(%lf°) = %lf\n", x1, result);
            }

            if (choice == 18)
            {
                double a,b,c;
                printf("Enter a (coefficient of x^2): ");
                scanf("%lf", &a);
                printf("Enter b (coefficient of x): ");
                scanf("%lf", &b);
                printf("Enter c (constant term): ");
                scanf("%lf", &c);

                quadratic_eq(a,b,c);

                result = b*b - 4*a*c;
                *(calc_hist+index) = result;
                index++;
            }

            if (choice == 19)
            {
                double a,b;
                printf("Enter a (coefficient of x): ");
                scanf("%lf", &a);
                printf("Enter b (constant term): ");
                scanf("%lf", &b);

                linear_eq(a,b);

                if (a != 0){
                    result = -b / a;
                    *(calc_hist+index) = result;
                    index++;
                }
            }

        }
        
    } while (choice!=20); // exit

    printf("Exit the program.\n");
    free(calc_hist);

    return 0;
    
}
