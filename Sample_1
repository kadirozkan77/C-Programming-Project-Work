#include <stdio.h>
#include <math.h> // only for sqrt() function
#include<stdlib.h>
#include <string.h>

const double PI=3.14159265359; // for circle calculations

double summation(double x1, double x2){
    return x1+x2;
}

double subtraction(double x1, double x2){
    return x1-x2;
}

double division(double x1, double x2){
    return x1/x2;
}

double multiplication(double x1, double x2){
    return x1*x2;
}
double square_root(double x1){
    return sqrt(x1);
}
double area_circ(double x1){
    return PI*x1*x1;
}
double circumference_circ(double x1){
    return 2*PI*x1;
}
double deg_to_rad(double x1){
    return (x1*PI)/180;
}

double exponential_f(double x1, int exponent){
    double mult=1.0;
    for (int i = 0; i < exponent; i++)
    {
        mult*=x1;
    }
    return mult;
    
}

double factoriel(int x1){
    int mult=1;
    for(int i=1;i<=x1;i++){
        mult*=i;
    }
    return mult;
}

double average(int length,int arr[]){
    int tot=0;
    for(int i=0;i<length;i++){
        tot+=arr[i];
    }
    return (double) tot/length;
}

double std(int length, int arr[]){
    int mean=average(length,arr); // takes from the previous function
    int tot=0;
    for(int i=0;i<length;i++){
        tot+=(arr[i]-mean)*(arr[i]-mean);
    }
    return sqrt(tot)/length;
}




int main(){
    int choice,calc_space,index=0,angle,exponent,f_number; // angle is for deg_to_rad; exponent is for exponential ; f_number is for factoriel
    double x1,x2,result;
    int extra_calc_space=0; // allocating new memory for new calculations initially it is 0 because to assign a number to run the conditions
    int extra_calc_choice; // will take 1 or 0 to determine add new calculations or not
    char **calc_hist; // allocate memory for strings
    int arr_length; // length of the below array
    int array[arr_length]; // this array is for mean and standart deviation calculations
    printf("How many calculations do you want to make? ");
    scanf("%d",&calc_space);
    calc_hist= malloc(calc_space * sizeof(char*));
    if (calc_hist==NULL)
    {
        printf("Memory allocation has been failed! \n");
    }
    else{
        printf("Memory allocation has been succeeded. \n");
    }

    do
    { 
        // menu
        printf("MENU\n");
        printf("---------------\n");
        printf("1) Summation: \n");
        printf("2) Subtraction: \n");
        printf("3) Multiplication: \n");
        printf("4) Division: \n");
        printf("5) Show history. \n");
        printf("6) Square root: \n");
        printf("7) Area of the circle: \n");
        printf("8) Circumference of the circle: \n");
        printf("9) Convert degree to rad: \n");
        printf("10) Exponential (x^y) : \n");
        printf("11) Factoriel : \n");
        printf("12) Average of the given numbers : \n");
        printf("13) Standart deviation of the given list of numbers : \n");
        printf("14) Exit. \n");
        if(index==calc_space+extra_calc_space){
            printf("You achieved maximum limit of calculatons that you entered.\n");
            printf("Do you want to calculate more? 1:Yes 0:No");
            scanf("%d",&extra_calc_choice);
            if (extra_calc_choice==1)
            {
                printf("How many more calculations do you want to make?");
                scanf("%d",&extra_calc_space);
                calc_hist = realloc(calc_hist, (calc_space + extra_calc_space) * sizeof(char*));
                
            }
            else{
                printf("Exit the program. \n");
                return 0;
            }
            

        }
        // choice selection
        printf("Please enter your choice 1-14: ");
        scanf("%d",&choice);

        if (choice>14 || choice<1)
        {
            printf("Please enter number between 1 and 5.\n");
        }
        else
        {
            if (choice==1) // summation
            {
                printf("Please enter the first number: ");
                scanf("%lf",&x1);
                printf("Please enter the second number: ");
                scanf("%lf",&x2);
                result=summation(x1,x2);
                char temp[100];// create a temporary buffer for formating text
                sprintf(temp, "%lf + %lf = %lf",x1, x2, result); // format text into a string(char array)
                calc_hist[index] = malloc(strlen(temp)+1); // allocate memory in history for string
                strcpy(calc_hist[index], temp); // copy formatted string into history
                index++;
                printf("%s\n",temp);

            }
            if (choice==2) // subtraction
            {
                printf("Please enter the first number: ");
                scanf("%lf",&x1);
                printf("Please enter the second number: ");
                scanf("%lf",&x2);
                result=subtraction(x1,x2);
                char temp[100];
                sprintf(temp, "%lf - %lf = %lf",x1, x2, result); 
                calc_hist[index] = malloc(strlen(temp)+1); 
                strcpy(calc_hist[index], temp); 
                index++;
                printf("%s\n",temp);
            }
            if (choice==3) // multiplication
            {
                printf("Please enter the first number: ");
                scanf("%lf",&x1);
                printf("Please enter the second number: ");
                scanf("%lf",&x2);
                result=multiplication(x1,x2);
                char temp[100];
                sprintf(temp, "%lf * %lf = %lf",x1, x2, result); 
                calc_hist[index] = malloc(strlen(temp)+1); 
                strcpy(calc_hist[index], temp); 
                index++;
                printf("%s\n",temp);
            }
            if (choice==4) // divison
            {
                printf("Please enter the first number: ");
                scanf("%lf",&x1);
                printf("Please enter the second number: ");
                scanf("%lf",&x2);
                result=division(x1,x2);
                char temp[100];
                sprintf(temp, "%lf / %lf = %lf",x1, x2, result); 
                calc_hist[index] = malloc(strlen(temp)+1); 
                strcpy(calc_hist[index], temp); 
                index++;
                printf("%s\n",temp);
            }
            if (choice==5) // history save
            {
                for(int i=0;i<index;i++){
                    printf("%d. calculation: %s\n", i+1, calc_hist[i]);
                }
            }
            if (choice==6) // square root
            {
                printf("Please enter the first number: ");
                scanf("%lf",&x1);
                result=square_root(x1);
                char temp[100];
                sprintf(temp, "sqrt(%lf) = %lf \n",x1, result); 
                calc_hist[index] = malloc(strlen(temp)+1); 
                strcpy(calc_hist[index], temp); 
                index++;
                printf("%s\n",temp);
            }
            if (choice==7) // area of the circle
            {
                printf("Please enter the radius of the circle: ");
                scanf("%lf",&x1);
                result=area_circ(x1);
                char temp[100];
                sprintf(temp, "%lf * %lf * %lf = %lf \n",PI,x1,x1, result); 
                calc_hist[index] = malloc(strlen(temp)+1); 
                strcpy(calc_hist[index], temp); 
                index++;
                printf("%s\n",temp);
            }
            if (choice==8) // circumference of the circle
            {
                printf("Please enter the radius of the circle: ");
                scanf("%lf",&x1);
                result=circumference_circ(x1);
                char temp[100];
                sprintf(temp, "2 * %lf * %lf = %lf \n",PI,x1, result); 
                calc_hist[index] = malloc(strlen(temp)+1); 
                strcpy(calc_hist[index], temp); 
                index++;
                printf("%s\n",temp);
            }
            if (choice==9) // degrees to rad
            {
                printf("Please enter an angle in degrees to convert rad: ");
                scanf("%d",&angle);
                result=deg_to_rad(angle);
                char temp[100];
                sprintf(temp, "%d degrees = %lf rad \n",angle, result); 
                calc_hist[index] = malloc(strlen(temp)+1); 
                strcpy(calc_hist[index], temp); 
                index++;
                printf("%s\n",temp);
            }
            if (choice==10) // exponential
            {
                printf("Please enter the base: ");
                scanf("%lf",&x1);
                printf("Please enter the exponent: ");
                scanf("%d",&exponent);
                result=exponential_f(x1,exponent);
                char temp[100];
                sprintf(temp, "%lf ^ %d = %lf \n",x1,exponent, result); 
                calc_hist[index] = malloc(strlen(temp)+1); 
                strcpy(calc_hist[index], temp); 
                index++;
                printf("%s\n",temp);
            }
            if (choice==11) // factoriel
            {
                printf("Please enter the number to achieve factoriel: ");
                scanf("%d",&f_number);
                result=factoriel(f_number);
                char temp[100];
                sprintf(temp, "%d ! = %d \n",f_number,(int)result); 
                calc_hist[index] = malloc(strlen(temp)+1); 
                strcpy(calc_hist[index], temp); 
                index++;
                printf("%s\n",temp);
            }
            if (choice==12) // calculating mean
            {
                printf("Please enter the lenght of the list of numbers: ");
                scanf("%d",&arr_length);
                for(int i=0;i<arr_length;i++){
                    printf("Please enter a number to add the list: ");
                    scanf("%d",&array[i]); // appending numbers to array
                }
                result=average(arr_length,array);
                char temp[100];
                sprintf(temp, "Average of the given numbers is: %lf \n",result); 
                calc_hist[index] = malloc(strlen(temp)+1); 
                strcpy(calc_hist[index], temp); 
                index++;
                printf("%s\n",temp);
            }
            if (choice==13) // standard deviation
            {
                printf("Please enter the lenght of the list of numbers: ");
                scanf("%d",&arr_length);
                for(int i=0;i<arr_length;i++){
                    printf("Please enter a number to add the list: ");
                    scanf("%d",&array[i]); // appending numbers to array
                }
                result=std(arr_length,array);
                char temp[100];
                sprintf(temp, "Standart deviation of the given numbers is: %lf \n",result); 
                calc_hist[index] = malloc(strlen(temp)+1); 
                strcpy(calc_hist[index], temp); 
                index++;
                printf("%s\n",temp);
            }
        }
        
        
    } while (choice!=14); // exit
    printf("Exit the program.\n");
    free(calc_hist);

    return 0;
    
}

